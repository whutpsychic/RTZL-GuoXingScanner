System.register(["./el-table-column-legacy-aa4a13aa.js","./index-legacy-37ee8fb2.js","./chukudan-legacy-0a2ecc54.js","./btn_queren-legacy-7f409558.js","./btn_shoudong-legacy-bfef57fe.js","./btn_tichu-legacy-29a262ad.js"],(function(a,e){"use strict";var t,l,n,o,i,r,c,d,s,u,b,v,h,f,m,p,g,y,k,w,j,C,N,_,x,D,L,q,I,U;return{setters:[a=>{t=a.E,l=a.a},a=>{n=a._,o=a.I,i=a.a,r=a.j,c=a.r,d=a.u,s=a.k,u=a.l,b=a.e,v=a.s,h=a.o,f=a.c,m=a.b,p=a.d,g=a.w,y=a.q,k=a.g,w=a.N,j=a.v,C=a.t,N=a.p,_=a.h},a=>{x=a.b,D=a.d,L=a.s},a=>{q=a._},a=>{I=a._},a=>{U=a._}],execute:function(){var e=document.createElement("style");e.textContent=".container[data-v-ca64045f]{display:flex;flex-direction:column;justify-content:space-between}.container>#data-area1[data-v-ca64045f]{margin-bottom:5%;flex-grow:1}.btn-area div[data-v-ca64045f]{border-radius:25px;font-size:20px;width:30%;min-height:50px}.btn-area img[data-v-ca64045f]{width:45px}.btn-area>div[data-v-ca64045f]:nth-child(2){background-color:var(--btn-color2)}.btn-area>div[data-v-ca64045f]:nth-child(1){background-color:var(--btn-color1)}.btn-area>div[data-v-ca64045f]:nth-child(3){background-color:var(--btn-color1)}[data-v-ca64045f] #data-area2 .el-table__cell{background-color:var(--table-body-back-color2)}[data-v-ca64045f] #data-area2 .el-table__cell{border:1px solid var(--table-body-border-color2)}\n",document.head.appendChild(e);const E={setup(){o({duration:3e3});const a=i(),e=r();let t=c([]),l=c([{yingjian:0,yijian:0,queshao:0},{yingjian:"",yijian:0,queshao:""}]);const n=d();s.await("scanner",(a=>{g(a)}));let h=0,f=0,m="";const p=a=>{let e=n.state.chukudanListInfo;l.value[0].yingjian=e.planNum,l.value[0].queshao=e.planNum,h=0,f=0,a.forEach((a=>{h+=a.blocks,f+=a.weight})),l.value[0].yijian=f,l.value[1].yijian=h,f>0&&(l.value[0].queshao=(l.value[0].yingjian-f).toFixed(2)),l.value[0].queshao<0&&b("请求数量过多！")};u((()=>{let a=e.query.barcode,l=n.state.scandList||[];t.value=l,p(l),g(a)}));const g=a=>{if(a){if(!x(a.trim()))return void b("条形码不符合规范");for(let e=0;e<t.value.length;e++)if(t.value[e].barcode==a)return void b("该批次已经选择，请勿重复选择！");v("加载中"),D(a).then((a=>{!0===a.data.value?b(a.data.message):(t.value.push(a.data.value),n.commit("setScandList",t.value),p(t.value))}))}};return{onClickLeft:()=>history.back(),tableData1:t,tableData2:l,onHandle:()=>{a.push({name:"manualUnqualifiedBarcodes"})},onConfirm:()=>{if(0==t.value.length)return void b("没有拣配数据");n.state.chukudan;let e=n.state.chukudanListInfo,l=n.state.carInfo,o=n.state.userInfo,i={};i.carNo=l.plateNo,i.carUnit=l.forwardingUnit,i.deliveryNo=l.deliveryNo,i.materialCode=e.materialCode,i.materialId=e.materialDescribeId,i.materialName=e.materialDescribe,i.pickPackage=h,i.pickPerson=o.userId,i.pickWeight=f,i.receiveUnit=e.receiveUnit,i.remark=e.remark,i.sendPlanNo=e.billNo,i.type=e.type,i.unit=e.unit,i.warehouseCode=l.warehouseCode,i.warehouseName=l.warehouseName;let r=[];t.value.forEach((a=>{let e={};e.barcode=a.barcode,e.batchNo=a.batchNo,e.blocks=a.blocks,e.carNo=l.plateNo,e.code=a.code,e.unit=a.unit,e.weight=a.weight,r.push(e)})),v(),L({pickBill:i,pickBillDetailList:r}).then((e=>{(e.data.state=!0)?(t.value=[],n.commit("setScandList",t.value),k({message:"拣配成功!",type:"success",className:"toast",overlay:!0}),setTimeout((()=>{a.push({name:"chukudanQuery"})}),2e3)):b(e.data.message)}))},selectRow:(a,e,t)=>{m=y(a)},onDelete:()=>{if(m){let a=t.value.filter((a=>a.barcode!=m.barcode));t.value=a,n.commit("setScandList",t.value),m="",p(a)}else b("请选择要剔除的行！")}}}},R=a=>(N("data-v-ca64045f"),a=a(),_(),a),S={class:"container"},B={class:"btn-area"},H=[R((()=>p("img",{src:q,alt:""},null,-1))),R((()=>p("div",null,"确认",-1)))],P=[R((()=>p("img",{src:I,alt:"",type:"primary"},null,-1))),R((()=>p("div",null,"手动",-1)))],z=[R((()=>p("img",{src:U,alt:"",type:"primary"},null,-1))),R((()=>p("div",null,"剔除",-1)))];a("default",n(E,[["render",function(a,e,n,o,i,r){const c=w,d=l,s=t;return h(),f("main",null,[m(c,{title:"拣配",class:"page-nav-bar","left-arrow":"",onClickLeft:o.onClickLeft},null,8,["onClickLeft"]),p("div",S,[m(s,{data:o.tableData1,border:"",id:"data-area1",onRowClick:o.selectRow},{default:g((()=>[m(d,{label:"日期"},{default:g((a=>[j(C(a.row.proDate.substr(0,10)),1)])),_:1}),m(d,{prop:"barcode",label:"条形码"}),m(d,{prop:"weight",label:"重量"})])),_:1},8,["data","onRowClick"]),m(s,{data:o.tableData2,border:"",id:"data-area2"},{default:g((()=>[m(d,{prop:"yingjian",label:"应拣"}),m(d,{prop:"yijian",label:"已拣"}),m(d,{prop:"queshao",label:"缺少"})])),_:1},8,["data"]),p("div",B,[p("div",{onClick:e[0]||(e[0]=(...a)=>o.onConfirm&&o.onConfirm(...a))},H),p("div",{onClick:e[1]||(e[1]=(...a)=>o.onHandle&&o.onHandle(...a))},P),p("div",{onClick:e[2]||(e[2]=(...a)=>o.onDelete&&o.onDelete(...a))},z)])])])}],["__scopeId","data-v-ca64045f"]]))}}}));
