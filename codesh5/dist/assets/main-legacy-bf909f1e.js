System.register(["./el-table-column-legacy-ce93b4d3.js","./index-legacy-d25ab013.js","./chukudan-legacy-ab533f6a.js","./btn_queren-legacy-7f409558.js","./btn_shoudong-legacy-bfef57fe.js","./btn_tichu-legacy-29a262ad.js"],(function(a,e){"use strict";var t,l,n,i,o,r,c,d,s,u,b,v,m,f,h,p,g,y,k,w,C,j,L,N,_,x,D,q,I,U;return{setters:[a=>{t=a.E,l=a.a},a=>{n=a._,i=a.I,o=a.a,r=a.k,c=a.r,d=a.u,s=a.l,u=a.m,b=a.e,v=a.s,m=a.o,f=a.c,h=a.b,p=a.d,g=a.w,y=a.q,k=a.g,w=a.N,C=a.v,j=a.t,L=a.p,N=a.i},a=>{_=a.b,x=a.d,D=a.s},a=>{q=a._},a=>{I=a._},a=>{U=a._}],execute:function(){var e=document.createElement("style");e.textContent=".container[data-v-c99e874f]{display:flex;flex-direction:column;justify-content:space-between}.container>#data-area1[data-v-c99e874f]{margin-bottom:5%;flex-grow:1}.btn-area div[data-v-c99e874f]{border-radius:25px;font-size:20px;width:30%;min-height:50px}.btn-area img[data-v-c99e874f]{width:45px}.btn-area>div[data-v-c99e874f]:nth-child(2){background-color:var(--btn-color2)}.btn-area>div[data-v-c99e874f]:nth-child(1){background-color:var(--btn-color1)}.btn-area>div[data-v-c99e874f]:nth-child(3){background-color:var(--btn-color1)}[data-v-c99e874f] #data-area2 .el-table__cell{background-color:var(--table-body-back-color2)}[data-v-c99e874f] #data-area2 .el-table__cell{border:1px solid var(--table-body-border-color2)}\n",document.head.appendChild(e);const E={setup(){i({duration:3e3});const a=o(),e=r();let t=c([]),l=c([{yingjian:0,yijian:0,queshao:0},{yingjian:"",yijian:0,queshao:""}]);const n=d();s.await("scanner",(a=>{g(a)}));let m=0,f=0,h="";const p=a=>{let e=n.state.chukudanListInfo;l.value[0].yingjian=e.planNum,l.value[0].queshao=e.planNum,m=0,f=0,a.forEach((a=>{m+=a.blocks,f+=a.weight})),l.value[0].yijian=f,l.value[1].yijian=m,f>0&&(l.value[0].queshao=(l.value[0].yingjian-f/1e3).toFixed(4)),l.value[0].queshao<0&&b("请求数量过多！")};u((()=>{let a=e.query.barcode,l=n.state.scandList||[];t.value=l,p(l),g(a)}));const g=a=>{if(a){if(!_(a.trim()))return void b("条形码不符合规范");for(let e=0;e<scandList.length;e++)if(scandList[e].barcode==a)return void b("该批次已经选择，请勿重复选择！");v("加载中"),x(a).then((a=>{!0===a.data.value?b(a.data.message):(scandList.push(a.data.value),n.commit("setScandList",scandList),t.value=scandList,p(scandList))}))}};return{onClickLeft:()=>history.back(),tableData1:t,tableData2:l,onHandle:()=>{a.push({name:"manualUnqualifiedBarcodes"})},onConfirm:()=>{if(0==t.value.length)return void b("没有拣配数据");n.state.chukudan;let e=n.state.chukudanListInfo,l=n.state.carInfo,i=n.state.userInfo,o={};o.carNo=l.plateNo,o.carUnit=l.forwardingUnit,o.deliveryNo=l.deliveryNo,o.materialCode=e.materialCode,o.materialId=e.materialDescribeId,o.materialName=e.materialDescribe,o.pickPackage=m,o.pickPerson=i.userId,o.pickWeight=f,o.receiveUnit=e.receiveUnit,o.remark=e.remark,o.sendPlanNo=e.billNo,o.type=e.type,o.unit=e.unit,o.warehouseCode=l.warehouseCode,o.warehouseName=l.warehouseName;let r=[];t.value.forEach((a=>{let e={};e.barcode=a.barcode,e.batchNo=a.batchNo,e.blocks=a.blocks,e.carNo=l.plateNo,e.code=a.code,e.unit=a.unit,e.weight=a.weight,r.push(e)})),v(),D({pickBill:o,pickBillDetailList:r}).then((e=>{(e.data.state=!0)?(t.value=[],n.commit("setScandList",t.value),k({message:"拣配成功!",type:"success",className:"toast",overlay:!0}),setTimeout((()=>{a.push({name:"chukudanQuery"})}),2e3)):b(e.data.message)}))},selectRow:(a,e,t)=>{h=y(a)},onDelete:()=>{if(h){let a=t.value.filter((a=>a.barcode!=h.barcode));t.value=a,n.commit("setScandList",t.value),h="",p(a)}else b("请选择要剔除的行！")}}}},R=a=>(L("data-v-c99e874f"),a=a(),N(),a),S={class:"container"},B={class:"btn-area"},H=[R((()=>p("img",{src:q,alt:""},null,-1))),R((()=>p("div",null,"确认",-1)))],P=[R((()=>p("img",{src:I,alt:"",type:"primary"},null,-1))),R((()=>p("div",null,"手动",-1)))],z=[R((()=>p("img",{src:U,alt:"",type:"primary"},null,-1))),R((()=>p("div",null,"剔除",-1)))];a("default",n(E,[["render",function(a,e,n,i,o,r){const c=w,d=l,s=t;return m(),f("main",null,[h(c,{title:"拣配",class:"page-nav-bar","left-arrow":"",onClickLeft:i.onClickLeft},null,8,["onClickLeft"]),p("div",S,[h(s,{data:i.tableData1,border:"",id:"data-area1",onRowClick:i.selectRow},{default:g((()=>[h(d,{label:"日期"},{default:g((a=>[C(j(a.row.proDate.substr(0,10)),1)])),_:1}),h(d,{prop:"barcode",label:"条形码"}),h(d,{prop:"weight",label:"重量"})])),_:1},8,["data","onRowClick"]),h(s,{data:i.tableData2,border:"",id:"data-area2"},{default:g((()=>[h(d,{prop:"yingjian",label:"应拣"}),h(d,{prop:"yijian",label:"已拣"}),h(d,{prop:"queshao",label:"缺少"})])),_:1},8,["data"]),p("div",B,[p("div",{onClick:e[0]||(e[0]=(...a)=>i.onConfirm&&i.onConfirm(...a))},H),p("div",{onClick:e[1]||(e[1]=(...a)=>i.onHandle&&i.onHandle(...a))},P),p("div",{onClick:e[2]||(e[2]=(...a)=>i.onDelete&&i.onDelete(...a))},z)])])])}],["__scopeId","data-v-c99e874f"]]))}}}));
